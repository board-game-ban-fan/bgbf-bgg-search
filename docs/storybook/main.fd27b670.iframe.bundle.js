(self.webpackChunkbgbf_bgg_search=self.webpackChunkbgbf_bgg_search||[]).push([[179],{"./src/BggSearchInput/BggSearchInput.stories.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:function(){return Primary},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return BggSearchInput_stories}});var objectSpread2=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectWithoutProperties=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),regenerator=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),react=__webpack_require__("./node_modules/react/index.js"),debounce=__webpack_require__("./node_modules/lodash/debounce.js"),debounce_default=__webpack_require__.n(debounce),throttle=__webpack_require__("./node_modules/lodash/throttle.js"),throttle_default=__webpack_require__.n(throttle),react_select_esm=__webpack_require__("./node_modules/react-select/async/dist/react-select.esm.js");function decodeHtml(str){return decodeURIComponent(str).replace(/&#039;/g,"'")}var lib_module=__webpack_require__("./node_modules/bgg-xml-api-client/lib/module/index.js"),BggSearchInput_module={},jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),_excluded=["isGetFullGameData","onChangeInput","onChangeSelect","placeholder"],_excluded2=["id","name","yearpublished"],BggSearchInput=react.memo((function(_ref){var _ref$isGetFullGameDat=_ref.isGetFullGameData,isGetFullGameData=void 0!==_ref$isGetFullGameDat&&_ref$isGetFullGameDat,onChangeInput=_ref.onChangeInput,_ref$onChangeSelect=_ref.onChangeSelect,onChangeSelect=void 0===_ref$onChangeSelect?function(val){console.log("select: ".concat(val," (you should pass onChangeSelect prop)"))}:_ref$onChangeSelect,_ref$placeholder=_ref.placeholder,placeholder=void 0===_ref$placeholder?"Search by BGG...":_ref$placeholder,restProps=(0,objectWithoutProperties.Z)(_ref,_excluded),getBggList=(0,react.useCallback)(function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(name,cb){var _yield$bggXmlApiClien,data,item,total,res;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,lib_module.ZP.get("search",{query:name,type:"boardgame"});case 3:if(_yield$bggXmlApiClien=_context.sent,data=_yield$bggXmlApiClien.data,item=data.item,"0"!==(total=data.total)){_context.next=8;break}return _context.abrupt("return");case 8:return res=("1"===total?[item]:item).map((function(_ref3){var id=_ref3.id,name=_ref3.name.value,yearpublished=_ref3.yearpublished,rest=(0,objectWithoutProperties.Z)(_ref3,_excluded2),year=null==yearpublished?void 0:yearpublished.value;return(0,objectSpread2.Z)({label:"".concat(decodeHtml(name)).concat(year?" ("+year+")":""),name:name,id:id,value:id,year:year},rest)})),_context.abrupt("return",res);case 13:return _context.prev=13,_context.t0=_context.catch(0),console.log(_context.t0),_context.abrupt("return");case 17:case"end":return _context.stop()}}),_callee,null,[[0,13]])})));return function(_x,_x2){return _ref2.apply(this,arguments)}}(),[]),getBggGameData=(0,react.useCallback)(function(){var _ref4=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(id){var _yield$bggXmlApiClien2,data;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,lib_module.ZP.get("thing",{id:id,type:"boardgame,boardgameexpansion"});case 3:return _yield$bggXmlApiClien2=_context2.sent,data=_yield$bggXmlApiClien2.data,_context2.abrupt("return",null==data?void 0:data.item);case 8:return _context2.prev=8,_context2.t0=_context2.catch(0),console.log(_context2.t0),_context2.abrupt("return");case 12:case"end":return _context2.stop()}}),_callee2,null,[[0,8]])})));return function(_x3){return _ref4.apply(this,arguments)}}(),[]),throttleBggRequest=(0,react.useCallback)(throttle_default()(function(){var _ref5=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(type,val,cb){var switchMap,data;return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return switchMap={list:getBggList,game:getBggGameData},_context3.next=3,switchMap[type](val);case 3:data=_context3.sent,cb&&cb(data);case 5:case"end":return _context3.stop()}}),_callee3)})));return function(_x4,_x5,_x6){return _ref5.apply(this,arguments)}}(),5e3),[]),debounceGetList=(0,react.useCallback)(debounce_default()((function(val,callback){throttleBggRequest("list",val,callback)}),1e3),[]),getGameData=(0,react.useCallback)((function(id){return getBggGameData(id).then((function(data){return data.name.length?data.name.forEach((function(_ref6,index){var value=_ref6.value;data.name[index].value=decodeHtml(value)})):data.name.value=decodeHtml(data.name.value),data}))}),[]),loadOptions=(0,react.useCallback)((function(val,callback){debounceGetList(val,callback)}),[]),handleSelectChange=(0,react.useCallback)(function(){var _ref7=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee4(option){return regenerator_default().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:onChangeSelect(isGetFullGameData?getGameData(option.id):option);case 1:case"end":return _context4.stop()}}),_callee4)})));return function(_x7){return _ref7.apply(this,arguments)}}(),[isGetFullGameData]);return(0,jsx_runtime.jsx)(react_select_esm.Z,(0,objectSpread2.Z)({className:BggSearchInput_module.BggSearchInput,loadOptions:loadOptions,defaultOptions:!0,onInputChange:onChangeInput,onChange:handleSelectChange,placeholder:placeholder},restProps))})),BggSearchInput_BggSearchInput=BggSearchInput,BggSearchInput_stories_excluded=["isGetFullGameData"],BggSearchInput_stories={parameters:{storySource:{source:'import React, { useState, useCallback } from "react";\n\nimport BggSearchInput from "./BggSearchInput.jsx";\n\nexport default {\n  title: "BggSearchInput",\n  component: BggSearchInput,\n  argTypes: {\n    isGetFullGameData: { control: "boolean" },\n  },\n};\n\nconst Template = ({ isGetFullGameData, ...args }) => {\n  const [selectGame, setSelectGame] = useState();\n\n  const handleSelectChanged = useCallback(\n    async (res) => {\n      console.log(res);\n      try {\n        if (isGetFullGameData) {\n          // res is promise\n          setSelectGame("Loading Full Data...");\n          const data = await res;\n\n          console.log(data);\n          setSelectGame(data);\n        } else {\n          // res is data object\n          setSelectGame(res);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    [isGetFullGameData]\n  );\n\n  return (\n    <>\n      <BggSearchInput\n        {...args}\n        isGetFullGameData={isGetFullGameData}\n        onChangeSelect={handleSelectChanged}\n      />\n\n      {selectGame && (\n        <>\n          {isGetFullGameData ? (\n            <h3>\n              When isGetFullGameData equal to true, onChangeSelect callback will\n              get a Promise\n            </h3>\n          ) : (\n            <h3>onChangeSelect callback:</h3>\n          )}\n\n          <code style={{ whiteSpace: "pre-wrap" }}>\n            {JSON.stringify(selectGame, null, "  ")}\n          </code>\n        </>\n      )}\n    </>\n  );\n};\n\nexport const Primary = Template.bind({});\nPrimary.args = { isGetFullGameData: true };\n',locationsMap:{primary:{startLoc:{col:17,line:13},endLoc:{col:1,line:64},startBody:{col:17,line:13},endBody:{col:1,line:64}}}}},title:"BggSearchInput",component:BggSearchInput_BggSearchInput,argTypes:{isGetFullGameData:{control:"boolean"}}},Primary=function Template(_ref){var isGetFullGameData=_ref.isGetFullGameData,args=(0,objectWithoutProperties.Z)(_ref,BggSearchInput_stories_excluded),_useState=(0,react.useState)(),_useState2=(0,slicedToArray.Z)(_useState,2),selectGame=_useState2[0],setSelectGame=_useState2[1],handleSelectChanged=(0,react.useCallback)(function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(res){var data;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(console.log(res),_context.prev=1,!isGetFullGameData){_context.next=11;break}return setSelectGame("Loading Full Data..."),_context.next=6,res;case 6:data=_context.sent,console.log(data),setSelectGame(data),_context.next=12;break;case 11:setSelectGame(res);case 12:_context.next=17;break;case 14:_context.prev=14,_context.t0=_context.catch(1),console.log(_context.t0);case 17:case"end":return _context.stop()}}),_callee,null,[[1,14]])})));return function(_x){return _ref2.apply(this,arguments)}}(),[isGetFullGameData]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(BggSearchInput_BggSearchInput,(0,objectSpread2.Z)((0,objectSpread2.Z)({},args),{},{isGetFullGameData:isGetFullGameData,onChangeSelect:handleSelectChanged})),selectGame&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isGetFullGameData?(0,jsx_runtime.jsx)("h3",{children:"When isGetFullGameData equal to true, onChangeSelect callback will get a Promise"}):(0,jsx_runtime.jsx)("h3",{children:"onChangeSelect callback:"}),(0,jsx_runtime.jsx)("code",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(selectGame,null,"  ")})]})]})}.bind({});Primary.args={isGetFullGameData:!0},Primary.parameters=(0,objectSpread2.Z)({storySource:{source:'({ isGetFullGameData, ...args }) => {\n  const [selectGame, setSelectGame] = useState();\n\n  const handleSelectChanged = useCallback(\n    async (res) => {\n      console.log(res);\n      try {\n        if (isGetFullGameData) {\n          // res is promise\n          setSelectGame("Loading Full Data...");\n          const data = await res;\n\n          console.log(data);\n          setSelectGame(data);\n        } else {\n          // res is data object\n          setSelectGame(res);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    [isGetFullGameData]\n  );\n\n  return (\n    <>\n      <BggSearchInput\n        {...args}\n        isGetFullGameData={isGetFullGameData}\n        onChangeSelect={handleSelectChanged}\n      />\n\n      {selectGame && (\n        <>\n          {isGetFullGameData ? (\n            <h3>\n              When isGetFullGameData equal to true, onChangeSelect callback will\n              get a Promise\n            </h3>\n          ) : (\n            <h3>onChangeSelect callback:</h3>\n          )}\n\n          <code style={{ whiteSpace: "pre-wrap" }}>\n            {JSON.stringify(selectGame, null, "  ")}\n          </code>\n        </>\n      )}\n    </>\n  );\n}'}},Primary.parameters);var __namedExportsOrder=["Primary"]},"./.storybook/preview.js-generated-config-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,{__namedExportsOrder:function(){return __namedExportsOrder},parameters:function(){return parameters}});var ClientApi=__webpack_require__("./node_modules/@storybook/client-api/dist/esm/ClientApi.js"),parameters={actions:{argTypesRegex:"^on[A-Z].*"}},__namedExportsOrder=["parameters"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":return(0,ClientApi.uc)(value);case"argTypes":return(0,ClientApi.v9)(value);case"decorators":return value.forEach((function(decorator){return(0,ClientApi.$9)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return(0,ClientApi.HZ)(loader,!1)}));case"parameters":return(0,ClientApi.h1)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return(0,ClientApi.My)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return(0,ClientApi._C)(enhancer)}));case"render":return(0,ClientApi.$P)(value);case"globals":case"globalTypes":var v={};return v[key]=value,(0,ClientApi.h1)(v,!1);case"__namedExportsOrder":case"decorateStory":case"renderToDOM":return null;default:return console.log(key+" was not supported :( !")}}))},"./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Cjsx%7Cts%7Ctsx))$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./BggSearchInput/BggSearchInput.stories.js":"./src/BggSearchInput/BggSearchInput.stories.js"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Cjsx%7Cts%7Ctsx))$"},"./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$":function(module){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$",module.exports=webpackEmptyContext},"./storybook-init-framework-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},"?4f7e":function(){},"./generated-stories-entry.cjs":function(module,__unused_webpack_exports,__webpack_require__){"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$"),__webpack_require__("./src sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Cjsx%7Cts%7Ctsx))$")],module,!1)}},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId)};__webpack_require__.O(0,[748],(function(){return __webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_exec__("./storybook-init-framework-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/docs/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/preview/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-links/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-measure/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-outline/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-knobs/dist/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./.storybook/preview.js-generated-config-entry.js"),__webpack_exec__("./generated-stories-entry.cjs")}));__webpack_require__.O()}]);