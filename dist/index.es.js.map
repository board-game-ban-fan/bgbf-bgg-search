{"version":3,"file":"index.es.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/BggSearchInput/BggSearchInput.jsx"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { useRef, useState, useCallback, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport _debounce from \"lodash/debounce\";\nimport _throttle from \"lodash/throttle\";\nimport AsyncSelect from \"react-select/async\";\n\nimport bggXmlApiClient from \"bgg-xml-api-client\";\n\nimport sty from \"./BggSearchInput.module.scss\";\n\nconst BggSearchInput = React.memo(\n  ({\n    isGetFullGameData = false,\n    onChangeInput,\n    onChangeSelect = (val) => {\n      console.log(`select: ${val} (you should pass onChangeSelect prop)`);\n    },\n    placeholder = \"Search by BGG...\",\n    ...restProps\n  }) => {\n    const getBggList = useCallback(async (name, cb) => {\n      try {\n        const { data } = await bggXmlApiClient.get(\"search\", {\n          query: name,\n          type: \"boardgame\",\n        });\n\n        const { item, total } = data;\n\n        if (total === \"0\") return;\n\n        const items = total === \"1\" ? [item] : item;\n\n        const res = items.map(\n          ({ id, name: { value: name }, yearpublished, ...rest }) => {\n            const year = yearpublished?.value;\n            return {\n              label: `${name}${year ? \" (\" + year + \")\" : \"\"}`,\n              name,\n              id,\n              value: id,\n              year: year,\n              ...rest,\n            };\n          }\n        );\n        return res;\n      } catch (error) {\n        console.log(error);\n        return;\n      }\n    }, []);\n\n    const getBggGameData = useCallback(async (id) => {\n      try {\n        const { data } = await bggXmlApiClient.get(\"thing\", {\n          id,\n          type: \"boardgame,boardgameexpansion\",\n        });\n        return data?.item;\n      } catch (error) {\n        console.log(error);\n        return;\n      }\n    }, []);\n\n    const throttleBggRequest = useCallback(\n      _throttle(async (type, val, cb) => {\n        const switchMap = {\n          list: getBggList,\n          game: getBggGameData,\n        };\n\n        const data = await switchMap[type](val);\n        cb && cb(data);\n      }, 5000),\n      []\n    );\n\n    const debounceGetList = useCallback(\n      _debounce((val, callback) => {\n        throttleBggRequest(\"list\", val, callback);\n      }, 1000),\n      []\n    );\n\n    const getGameData = useCallback((id) => {\n      return getBggGameData(id);\n    }, []);\n\n    const loadOptions = useCallback((val, callback) => {\n      debounceGetList(val, callback);\n    }, []);\n\n    const handleSelectChange = useCallback(\n      async (option) => {\n        if (isGetFullGameData) {\n          onChangeSelect(getGameData(option.id));\n        } else {\n          onChangeSelect(option);\n        }\n      },\n      [isGetFullGameData]\n    );\n\n    return (\n      <AsyncSelect\n        className={sty.BggSearchInput}\n        // cacheOptions\n        loadOptions={loadOptions}\n        defaultOptions\n        onInputChange={onChangeInput}\n        onChange={handleSelectChange}\n        placeholder={placeholder}\n        {...restProps}\n      ></AsyncSelect>\n    );\n  }\n);\n\nBggSearchInput.propTypes = {\n  placeholder: PropTypes.string, //test\n  onChangeInput: PropTypes.func,\n  onChangeSelect: PropTypes.func,\n  isGetFullGameData: PropTypes.bool,\n};\n\nexport default BggSearchInput;\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","BggSearchInput","React","memo","_ref","_ref$isGetFullGameDat","isGetFullGameData","onChangeInput","_ref$onChangeSelect","onChangeSelect","val","console","log","concat","_ref$placeholder","placeholder","restProps","_objectWithoutProperties","_excluded","getBggList","useCallback","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","name","cb","_yield$bggXmlApiClien","data","item","total","res","wrap","_context","prev","next","bggXmlApiClient","get","query","sent","abrupt","map","_ref3","id","value","yearpublished","rest","_excluded2","year","_objectSpread","label","t0","stop","_x","_x2","apply","this","arguments","getBggGameData","_ref4","_yield$bggXmlApiClien2","_context2","_callee2","_x3","throttleBggRequest","_throttle","_ref5","switchMap","_context3","list","game","_callee3","_x4","_x5","_x6","debounceGetList","_debounce","callback","getGameData","loadOptions","handleSelectChange","_ref6","option","_context4","_callee4","_x7","AsyncSelect","_extends","className","sty","defaultOptions","onInputChange","onChange","propTypes","PropTypes","string","func","bool"],"mappings":"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"}